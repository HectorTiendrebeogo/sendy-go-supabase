!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("cross-fetch")):"function"==typeof define&&define.amd?define(["cross-fetch"],r):(t||self).ligdicash=r(t.crossFetch)}(this,function(t){function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=/*#__PURE__*/r(t);function n(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,"symbol"==typeof(i=function(t,r){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key))?i:String(i),n)}var i}function i(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(){return o=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},o.apply(this,arguments)}function u(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,c(t,r)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function c(t,r){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},c(t,r)}function s(t,r,e){return s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,r,e){var n=[null];n.push.apply(n,r);var i=new(Function.bind.apply(t,n));return e&&c(i,e.prototype),i},s.apply(null,arguments)}function l(t){var r="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return s(t,arguments,a(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),c(e,t)},l(t)}var h={test:"https://test.ligdicash.com/pay/v01/",live:"https://app.ligdicash.com/pay/v01/"},f=/*#__PURE__*/function(t){function r(r,e){var n;return(n=t.call(this,e)||this).code=void 0,n.code=r,n.name=e,n}return u(r,t),r}(/*#__PURE__*/l(Error)),p=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[AuthenticationError]: api_key ou auth_token invalide")||this}return u(r,t),r}(f),d=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[ApplicationAuthenticationError]: Impossible d'authentifier votre application")||this}return u(r,t),r}(f),m=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[RecipientOperatorNotIdentified]: L'opérateur du destinataire n'a pas été identifié")||this}return u(r,t),r}(f),v=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[MerchantBalanceLowError]: Solde Marchand insuffisant")||this}return u(r,t),r}(f),y=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[MerchantPayoutDisabledError]: Payout désactivé pour ce marchand")||this}return u(r,t),r}(f),_=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[MerchantPayinDisabledError]: Payin non activé pour ce marchand")||this}return u(r,t),r}(f),b=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[CustomerDoesNotExistError]: Client non enregistré sur la plateforme")||this}return u(r,t),r}(f),P=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[TransactionAlreadyExistError]: La transaction existe déjà")||this}return u(r,t),r}(f),g=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[UnauthorizedCurrencyConversionError]: Conversion de devise non autorisée")||this}return u(r,t),r}(f),k=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[InvoiceNotFoundError]: Facture introuvable")||this}return u(r,t),r}(f),E=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[InvalidAmountError]: Montant invalide. Il doit être compris entre 20 et 1 000 000.")||this}return u(r,t),r}(f),w=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[MerchantAccountDoesNotExistError]: Aucun compte marchand sur le réseau spécifié")||this}return u(r,t),r}(f),j=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[NoPendProcPayout24HError]: Aucun paiement en attente ou traité au cours des dernières 24 heures")||this}return u(r,t),r}(f),O=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[NoDeposit3MError]: Aucun paiement en attente ou traité au cours des 3 derniers mois")||this}return u(r,t),r}(f),T=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"Le montant demandé est en dehors de l'intervalle [20;1000000].")||this}return u(r,t),r}(f),A=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[IpDeniedError]: Adresse IP refusée.")||this}return u(r,t),r}(f),U=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[ProcessingError]: Une erreur s'est produite pendant le traitement.")||this}return u(r,t),r}(f),I=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[SendingError]: Une erreur s'est produite pendant l'envoi.")||this}return u(r,t),r}(f),x=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[DataInputError]: Données incorrectes.")||this}return u(r,t),r}(f),q=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[ApiError]: Erreur d'API.")||this}return u(r,t),r}(f),K=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[NoHashError]: Aucun hash fourni.")||this}return u(r,t),r}(f),M=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[InvalidHashError]: Hash invalide.")||this}return u(r,t),r}(f),D=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[NoNetworkAccessConfigurationError]: Aucun accès réseau configuré.")||this}return u(r,t),r}(f),R=/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[UnauthorizedMethodError]: Methode non autorisée.")||this}return u(r,t),r}(f),N={payin:{test:{"00":p,"01":d,"02":E,"03":A,"04":U},live:{"00":p,"01":_,"02":E,"03":A,"04":U,"05":I,"06":I,"07":D,"08":x,"09":q,10:K,11:M,12:/*#__PURE__*/function(t){function r(r){return t.call(this,r,"[InvalidMethodError]: Methode invalide.")||this}return u(r,t),r}(f),13:R}},client_payout:{test:{"00":p,"01":y,"02":b,"03":w,"03a":j,"03b":O,"04":v,"05":T,"06":A,"07":P,"08":U,"09":x,10:q,13:K,14:M},live:{"00":p,"01":y,"02":b,"03":w,"03a":j,"03b":O,"04":v,"05":T,"06":A,"07":P,"08":U,"09":x,10:q,13:K,14:M}},merchant_payout:{test:{"00":p,"01":d,"02":T,"03":w,"04":j,"05":m,"06":w,"07":w,"08":v,"09":U,10:q,11:K,12:M,13:g,14:A},live:{"00":p,"01":d,"02":T,"03":w,"04":j,"05":m,"06":w,"07":w,"08":v,"09":U,10:q,11:K,12:M,13:g,14:A}},status:{test:{"00":p,"01":d,"02":k,"03":U},live:{"00":p,"01":_,"02":k,"03":U,"04":x}}},S=/*#__PURE__*/function(t){function r(){return t.apply(this,arguments)||this}u(r,t);var e=r.prototype;return e.getDataOrRaiseError=function(t,r){try{var e=t,n=t.response_text;if("00"==t.response_code){var i=t.custom_data;if(i&&i.length>0){var o=i.reduce(function(t,r){return t[r.keyof_customdata]=r.valueof_customdata,t},{});e.custom_data=o}return Promise.resolve(e)}var u=n.match(/\d{2,3}[a-z]?/i),a=u?u[0]:"",c=function(t,r,e){var n,i;return(null==N||null==(n=N[r])||null==(i=n[t])?void 0:i[e])||q}(this.platform,r,a);throw new c(a)}catch(t){return Promise.reject(t)}},e.get=function(t,r){try{var e=this;return Promise.resolve(e.request(t)).then(function(t){return Promise.resolve(e.getDataOrRaiseError(t,r))})}catch(t){return Promise.reject(t)}},e.post=function(t,r,e){try{var n=this;return Promise.resolve(n.request(t,{method:"POST",body:JSON.stringify(r)})).then(function(t){return Promise.resolve(n.getDataOrRaiseError(t,e))})}catch(t){return Promise.reject(t)}},r}(/*#__PURE__*/function(){function t(t){this.apiKey=void 0,this.authToken=void 0,this.baseUrl=void 0,this.platform=void 0,this.apiKey=t.apiKey,this.authToken=t.authToken,this.platform=t.platform||"test",this.baseUrl=t.baseUrl||h[t.platform]}var r=t.prototype;return r.buildUrl=function(t){return this.baseUrl+t},r.request=function(t,r){try{var n=this,i=n.buildUrl(t),u=o({},r,{headers:{Apikey:n.apiKey,Authorization:"Bearer "+n.authToken,Accept:"application/json","Content-Type":"application/json"}});return Promise.resolve(e.default(i,u)).then(function(t){if(t.ok)return t.json();throw new Error(t.statusText)})}catch(t){return Promise.reject(t)}},t}()),C=/*#__PURE__*/function(){function t(t){this.name=void 0,this.description="",this._unit_price=void 0,this._quantity=void 0,this._total_price=void 0,this.name=t.name,this.description=(null==t?void 0:t.description)||"",this.quantity=t.quantity,this.unit_price=t.unit_price,this._total_price=t.unit_price*t.quantity}return t.prototype.format=function(){return{name:this.name,description:this.description,quantity:this.quantity,unit_price:this.unit_price,total_price:this.total_price}},i(t,[{key:"quantity",get:function(){return this._quantity},set:function(t){this._quantity=t,this._total_price=this.unit_price*t}},{key:"unit_price",get:function(){return this._unit_price},set:function(t){this._unit_price=t,this._total_price=this._quantity*t}},{key:"total_price",get:function(){return this._total_price}}]),t}(),F=/*#__PURE__*/function(t){function r(r,e){var n;return(n=t.call(this,r)||this)._items=void 0,n.currency="xof",n.description="",n.customer_firstname="",n.customer_lastname="",n.customer_email="",n.store_name="",n.store_website_url="",n.external_id="",n.otp="",n._total_amount=0,n.currency=(null==e?void 0:e.currency)||"XOF",n.description=(null==e?void 0:e.description)||"",n.customer_firstname=(null==e?void 0:e.customer_firstname)||"",n.customer_lastname=(null==e?void 0:e.customer_lastname)||"",n.customer_email=(null==e?void 0:e.customer_email)||"",n.store_name=(null==e?void 0:e.store_name)||"",n.store_website_url=(null==e?void 0:e.store_website_url)||"",n._items=[],n}u(r,t);var e=r.prototype;return e.setItemsTotalAmount=function(){this._total_amount=this._items.reduce(function(t,r){return t+r.total_price},0)},e.addItem=function(t){this._items.push(new C(t)),this.setItemsTotalAmount()},e.formatInvoice=function(t){return void 0===t&&(t=""),{items:this._items.map(function(t){return t.format()}),total_amount:this._total_amount,devise:this.currency,description:this.description,customer:t||"",customer_firstname:this.customer_firstname,customer_lastname:this.customer_lastname,customer_email:this.customer_email,external_id:this.external_id,otp:this.otp}},e.formatPayload=function(t,r,e,n,i){void 0===t&&(t=""),void 0===r&&(r=null),void 0===e&&(e=null),void 0===n&&(n=""),void 0===i&&(i={});var o={callback_url:n};return r&&(o.cancel_url=r),e&&(o.return_url=e),{commande:{invoice:this.formatInvoice(t),store:{name:this.store_name,website_url:this.store_website_url},actions:o,custom_data:i}}},e.payWithRedirection=function(t){var r=t.cancel_url,e=void 0===r?"":r,n=t.return_url,i=void 0===n?"":n,o=t.callback_url,u=void 0===o?"":o,a=t.custom_data,c=void 0===a?{}:a;try{var s=this.formatPayload(null,e,i,u,c);return Promise.resolve(this.post("redirect/checkout-invoice/create",s,"payin"))}catch(t){return Promise.reject(t)}},e.payWithoutRedirection=function(t){var r=t.otp,e=void 0===r?"":r,n=t.customer,i=void 0===n?"":n,o=t.callback_url,u=void 0===o?"":o,a=t.custom_data,c=void 0===a?{}:a;try{var s=this;s.otp=e;var l=s.formatPayload(i,u,null,null,c);return Promise.resolve(s.post("straight/checkout-invoice/create",l,"payin"))}catch(t){return Promise.reject(t)}},i(r,[{key:"items",get:function(){return this._items}},{key:"total_amount",get:function(){return this._total_amount}}]),r}(S),z=/*#__PURE__*/function(t){function r(r,e,n,i){var o;return(o=t.call(this,r)||this).amount=0,o.description="",o.customer="",o.amount=e,o.description=n,o.customer=i,o}return u(r,t),r.prototype.send=function(t){try{var r=this,e={amount:r.amount,description:r.description,customer:r.customer,custom_data:t.custom_data||{},callback_url:t.callback_url||""};return"client"===t.type&&(e.to_ligdicash=t.to_wallet||!1),Promise.resolve(r.post("client"===t.type?"withdrawal/create":"straight/payout",{commande:e},"client"===t.type?"client_payout":"merchant_payout"))}catch(t){return Promise.reject(t)}},r}(S);/*#__PURE__*/
return function(){function t(t){this.apiKey=void 0,this.authToken=void 0,this.baseUrl=void 0,this.platform=void 0,this.apiKey=t.apiKey,this.authToken=t.authToken,this.platform=t.platform||"test",this.baseUrl=t.baseUrl}var r=t.prototype;return r.Withdrawal=function(t,r,e){return new z({apiKey:this.apiKey,authToken:this.authToken,platform:this.platform,baseUrl:this.baseUrl},t,r,e)},r.Invoice=function(t){return new F({apiKey:this.apiKey,authToken:this.authToken,platform:this.platform,baseUrl:this.baseUrl},t)},r.getTransaction=function(t,r){return void 0===r&&(r="payin"),function(t,r,e){void 0===e&&(e="payin");try{var n=new S(t);return Promise.resolve(n.get("payin"===e?"redirect/checkout-invoice/confirm/?invoiceToken="+r:"client_payout"===e?"withdrawal/confirm/?withdrawalToken="+r:"straight/payout/confirm/?payoutToken="+r,"status"))}catch(t){return Promise.reject(t)}}({apiKey:this.apiKey,authToken:this.authToken,platform:this.platform,baseUrl:this.baseUrl},t,r)},t}()});
//# sourceMappingURL=index.umd.js.map
